input{

#___________________SID=(MAXIMUSP)_Query=1(ActiveInactiveSessionCount)_____________________________
jdbc{
	jdbc_driver_library => "/etc/logstash/ojdbc8.jar"
        jdbc_driver_class => "oracle.jdbc.driver.OracleDriver"
        jdbc_connection_string => "jdbc:oracle:thin:@172.23.119.98:1521/MAXIMUSP"
        jdbc_user => "aiopsdb"
        jdbc_password => "sys#12345$"
        schedule => "40 * * * *"
        statement => "select inst_id,username,status,count(*) from gv$session where username is not null and username not in ('SYS','SYSTEM','DBSNMP') group by inst_id,username,status order by username, status"
        type => "ActiveInactiveSessionCount"
	add_field => {"IP" => "172.23.119.98"}
	add_field => {"SID" => "MAXIMUSP"}	
    }
#___________________SID=(MAXIMUSP)_Query=2(DiskGroupGreaterThan)_____________________________
jdbc{
		jdbc_driver_library => "/etc/logstash/ojdbc8.jar"
        jdbc_driver_class => "oracle.jdbc.driver.OracleDriver"
        jdbc_connection_string => "jdbc:oracle:thin:@172.23.119.98:1521/MAXIMUSP"
        jdbc_user => "aiopsdb"
        jdbc_password => "sys#12345$"
        schedule => "41 * * * *"
        statement => "select name,state,total_mb/1024,free_mb/1024,(((total_mb - free_mb)/1024)*100)/(total_mb/1024) pct_USED from v$asm_diskgroup"
        type => "DiskGroupGreaterThan"
	add_field => {"IP" => "172.23.119.98"}
		add_field => {"SID" => "MAXIMUSP"}	
    }
		
#___________________SID=(MAXIMUSP)_Query=3(DiskGroupStatus)_____________________________
jdbc{
	jdbc_driver_library => "/etc/logstash/ojdbc8.jar"
        jdbc_driver_class => "oracle.jdbc.driver.OracleDriver"
        jdbc_connection_string => "jdbc:oracle:thin:@172.23.119.98:1521/MAXIMUSP"
        jdbc_user => "aiopsdb"
        jdbc_password => "sys#12345$"
        schedule => "42 * * * *"
        statement => "select NAME,TOTAL_MB/1024 total_GB ,FREE_MB/1024 free_GB,TOTAL_MB/1024-FREE_MB/1024 Used_GB from v$asm_diskgroup"
        type => "DiskGroupStatus"
	add_field => {"IP" => "172.23.119.98"}
	add_field => {"SID" => "MAXIMUSP"}	
    }
	
#___________________SID=(MAXIMUSP)_Query=4(DbClientProcessStatus)_____________________________
jdbc{
	jdbc_driver_library => "/etc/logstash/ojdbc8.jar"
        jdbc_driver_class => "oracle.jdbc.driver.OracleDriver"
        jdbc_connection_string => "jdbc:oracle:thin:@172.23.119.98:1521/MAXIMUSP"
        jdbc_user => "aiopsdb"
        jdbc_password => "sys#12345$"
        schedule => "43 * * * *"
        statement => "select process,status,client_process,sequence#,block#,active_agents,known_agents from v$managed_standby"
        type => "DbClientProcessStatus"
	add_field => {"IP" => "172.23.119.98"}
	add_field => {"SID" => "MAXIMUSP"}	
    }
	
#___________________SID=(MAXIMUSP)_Query=5(CriticalWaitEvent)_____________________________
jdbc{
	jdbc_driver_library => "/etc/logstash/ojdbc8.jar"
        jdbc_driver_class => "oracle.jdbc.driver.OracleDriver"
        jdbc_connection_string => "jdbc:oracle:thin:@172.23.119.98:1521/MAXIMUSP"
        jdbc_user => "aiopsdb"
        jdbc_password => "sys#12345$"
        schedule => "44 * * * *"
        statement => "select (select name from v$database) DB_NAME, EVENT,INST_ID,COUNT(*) FROM GV$SESSION_WAIT WHERE EVENT LIKE  '%gc buffer%' OR EVENT LIKE '%shared%'or EVENT LIKE '%library%'or EVENT LIKE '%cursor%'  GROUP BY EVENT,INST_ID HAVING COUNT(*) > 0"
        type => "CriticalWaitEvent"
	add_field => {"IP" => "172.23.119.98"}
	add_field => {"SID" => "MAXIMUSP"}	
    }
					
#___________________SID=(MAXIMUSP)_Query=6(MonitorDRAndProdSyncStatus)_____________________________
jdbc{
	jdbc_driver_library => "/etc/logstash/ojdbc8.jar"
        jdbc_driver_class => "oracle.jdbc.driver.OracleDriver"
        jdbc_connection_string => "jdbc:oracle:thin:@172.23.119.98:1521/MAXIMUSP"
        jdbc_user => "aiopsdb"
        jdbc_password => "sys#12345$"
        schedule => "45 * * * *"
        statement => "select message,to_char(timestamp,'DD-MM-YY HH24:MI'),error_code from v$dataguard_status where error_code != 0"
        type => "MonitorDRAndProdSyncStatus"
	add_field => {"IP" => "172.23.119.98"}
	add_field => {"SID" => "MAXIMUSP"}	
    }
				   
#___________________SID=(MAXIMUSP)_Query=7(MonitorDRAndProdSyncStatus1)_____________________________
jdbc{
	jdbc_driver_library => "/etc/logstash/ojdbc8.jar"
        jdbc_driver_class => "oracle.jdbc.driver.OracleDriver"
        jdbc_connection_string => "jdbc:oracle:thin:@172.23.119.98:1521/MAXIMUSP"
        jdbc_user => "aiopsdb"
        jdbc_password => "sys#12345$"
        schedule => "46 * * * *"
        statement => "select process,status,client_process,sequence#,block#,active_agents,known_agents from v$managed_standby"
        type => "MonitorDRAndProdSyncStatus1"
	add_field => {"IP" => "172.23.119.98"}
	add_field => {"SID" => "MAXIMUSP"}	
    }
					   
#___________________SID=(MAXIMUSP)_Query=8(DB-PrdSiteSyncStatus)_____________________________
jdbc{
	jdbc_driver_library => "/etc/logstash/ojdbc8.jar"
        jdbc_driver_class => "oracle.jdbc.driver.OracleDriver"
        jdbc_connection_string => "jdbc:oracle:thin:@172.23.119.98:1521/MAXIMUSP"
        jdbc_user => "aiopsdb"
        jdbc_password => "sys#12345$"
        schedule => "47 * * * *"
        statement => "select dest_name, status, error from v$archive_dest where status<>'INACTIVE'"
        type => "DB-PrdSiteSyncStatus"
	add_field => {"IP" => "172.23.119.98"}
	add_field => {"SID" => "MAXIMUSP"}	
    }
					   
#___________________SID=(MAXIMUSP)_Query=9(DB-PrdSiteSyncStatus1)_____________________________
jdbc{
	jdbc_driver_library => "/etc/logstash/ojdbc8.jar"
        jdbc_driver_class => "oracle.jdbc.driver.OracleDriver"
        jdbc_connection_string => "jdbc:oracle:thin:@172.23.119.98:1521/MAXIMUSP"
        jdbc_user => "aiopsdb"
        jdbc_password => "sys#12345$"
        schedule => "48 * * * *"
        statement => "select message,to_char(timestamp,'DD-MM-YY HH24:MI'),error_code from v$dataguard_status where timestamp>=trunc(sysdate) and error_code != 0"
        type => "DB-PrdSiteSyncStatus1"
	add_field => {"IP" => "172.23.119.98"}
	add_field => {"SID" => "MAXIMUSP"}	
    }			   
}


output {
stdout { codec => rubydebug }
	influxdb {
			host => "172.23.119.147"
			port => 8086
			db => "OracleHealthQueries"
			user => "admin"
			password => "nivabupa@2022"
			measurement => "%{type}"
			allow_time_override => true
			max_retries => 3
			time_precision => "u"
			use_event_fields_for_data_points => true
			send_as_tags => ["query","type","IP","SID","username"]
			exclude_fields => ["@timestamp","@version"]
							}
								
		}

}